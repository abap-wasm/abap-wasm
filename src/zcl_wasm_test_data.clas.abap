CLASS zcl_wasm_test_data DEFINITION
  PUBLIC
  FINAL
  CREATE PUBLIC .

  PUBLIC SECTION.

    CLASS-METHODS wasm_add_two
      RETURNING
        VALUE(rv_xstr) TYPE xstring.

    CLASS-METHODS wasm_fibonacci
      RETURNING
        VALUE(rv_xstr) TYPE xstring.

    CLASS-METHODS wasm_factorial
      RETURNING
        VALUE(rv_xstr) TYPE xstring.

    CLASS-METHODS testsuite_i32
      RETURNING
        VALUE(rv_xstr) TYPE xstring.

    CLASS-METHODS testsuite_address
      RETURNING
        VALUE(rv_xstr) TYPE xstring.

    CLASS-METHODS testsuite_block
      RETURNING
        VALUE(rv_xstr) TYPE xstring.

  PROTECTED SECTION.
  PRIVATE SECTION.
ENDCLASS.



CLASS zcl_wasm_test_data IMPLEMENTATION.


  METHOD wasm_add_two.

* (module
*   (func $add (param $lhs i32) (param $rhs i32) (result i32)
*     get_local $lhs
*     get_local $rhs
*     i32.add)
*   (export "add" (func $add))
* )

    rv_xstr =
      |0061736D| && " magic
      |01000000| && " version
      |0107| && |0160027F7F017F| && " types
      |0302| && |0100| &&  " function
      |0707| && |01036164640000| && " export
      |0A09| && |010700| && |200020016A0B| && " code
      |001C| && |046E616D650106010003616464020D01000200036C68730103726873|.

  ENDMETHOD.


  METHOD wasm_fibonacci.

*(module
*  (type $t0 (func (param i32) (result i32)))
*  (func $fib (export "fib") (type $t0) (param $n i32) (result i32)
*    get_local $n
*    i32.const 2
*    i32.lt_s
*    if $I0
*      i32.const 1
*      return
*    end
*    get_local $n
*    i32.const 2
*    i32.sub
*    call $fib
*    get_local $n
*    i32.const 1
*    i32.sub
*    call $fib
*    i32.add
*    return))

    rv_xstr =
      |0061736D| && " magic
      |01000000| && " version
      |0106| && |0160017F017F| && " types
      |0302| && |0100| && " function
      |0707| && |01036669620000| && " export
      |0A1F| && |011D00| && " Start code section
        |2000| && " get local '00'
        |4102| && " const '02'
        |48| &&   " lt_s
        |0440| && " IF, blocktype = '40'
        |4101| && " const '01'
        |0F| &&   " return
        |0B| &&   " block end
        |2000| && " get local '00'
        |4102| && " const '02'
        |6B| &&   " subtract
        |1000| && " call '00'
        |2000| && " get local '00'
        |41016B10006A0F0B| &&
      |0015| && |046E616D650106010003666962020601000100016E|.

  ENDMETHOD.

  METHOD wasm_factorial.

    " (module
    " (func $fac (export "fac") (param i32) (result i32)
    "   local.get 0
    "   i32.const 1
    "   i32.lt_s
    "   if (result i32)
    "     i32.const 1
    "   else
    "     local.get 0
    "     local.get 0
    "     i32.const 1
    "     i32.sub
    "     call $fac
    "     i32.mul
    "   end))

    rv_xstr =
      |0061736D| && " magic
      |01000000| && " version
      |0106| && |0160017F017F| && " types
      |0302| && |0100| && " function
      |0707| && |01036661630000| && " export
      |0A19| && |011700| &&
      |2000| && " get local '00'
      |4101| && " const '01'
      |48| && " i32_lt_s
      |047F| && " if int32
      |410105| && " instructions 1
      |2000200041016B10006C0B| && " instructions 2
      |0B0012046E616D6501060100036661630203010000|.

  ENDMETHOD.

  METHOD testsuite_i32.

* https://github.com/WebAssembly/spec/blob/master/test/core/i32.wast

    rv_xstr =
      |0061736D01000000010C0260027F7F017F60017F017F03201F00000000000000| &&
      |00000000000000000101010101010000000000000000000007DE011F03616464| &&
      |0000037375620001036D756C0002056469765F730003056469765F7500040572| &&
      |656D5F7300050572656D5F75000603616E640007026F72000803786F72000903| &&
      |73686C000A057368725F73000B057368725F75000C04726F746C000D04726F74| &&
      |72000E03636C7A000F0363747A001006706F70636E74001109657874656E6438| &&
      |5F7300120A657874656E6431365F7300130365717A00140265710015026E6500| &&
      |16046C745F730017046C745F750018046C655F730019046C655F75001A046774| &&
      |5F73001B0467745F75001C0467655F73001D0467655F75001E0AED011F070020| &&
      |0020016A0B0700200020016B0B0700200020016C0B0700200020016D0B070020| &&
      |0020016E0B0700200020016F0B070020002001700B070020002001710B070020| &&
      |002001720B070020002001730B070020002001740B070020002001750B070020| &&
      |002001760B070020002001770B070020002001780B05002000670B0500200068| &&
      |0B05002000690B05002000C00B05002000C10B05002000450B07002000200146| &&
      |0B070020002001470B070020002001480B070020002001490B0700200020014C| &&
      |0B0700200020014D0B0700200020014A0B0700200020014B0B0700200020014E| &&
      |0B0700200020014F0B|.

  ENDMETHOD.

  METHOD testsuite_address.

* https://github.com/WebAssembly/spec/blob/master/test/core/address.wast

    rv_xstr =
      |0061736D01000000010A0260017F017F60017F00031F1E000000000000000000| &&
      |000000000000000000000000000000000101010101050301000107CD021E0838| &&
      |755F676F6F643100000838755F676F6F643200010838755F676F6F6433000208| &&
      |38755F676F6F643400030838755F676F6F643500040838735F676F6F64310005| &&
      |0838735F676F6F643200060838735F676F6F643300070838735F676F6F643400| &&
      |080838735F676F6F64350009093136755F676F6F6431000A093136755F676F6F| &&
      |6432000B093136755F676F6F6433000C093136755F676F6F6434000D09313675| &&
      |5F676F6F6435000E093136735F676F6F6431000F093136735F676F6F64320010| &&
      |093136735F676F6F64330011093136735F676F6F64340012093136735F676F6F| &&
      |643500130833325F676F6F643100140833325F676F6F643200150833325F676F| &&
      |6F643300160833325F676F6F643400170833325F676F6F643500180638755F62| &&
      |616400190638735F626164001A073136755F626164001B073136735F62616400| &&
      |1C0633325F626164001D0A8A021E070020002D00000B070020002D00000B0700| &&
      |20002D00010B070020002D00020B070020002D00190B070020002C00000B0700| &&
      |20002C00000B070020002C00010B070020002C00020B070020002C00190B0700| &&
      |20002F01000B070020002F00000B070020002F00010B070020002F01020B0700| &&
      |20002F01190B070020002E01000B070020002E00000B070020002E00010B0700| &&
      |20002E01020B070020002E01190B070020002802000B070020002800000B0700| &&
      |20002800010B070020002801020B070020002802190B0C0020002D00FFFFFFFF| &&
      |0F1A0B0C0020002C00FFFFFFFF0F1A0B0C0020002F01FFFFFFFF0F1A0B0C0020| &&
      |002E01FFFFFFFF0F1A0B0C0020002802FFFFFFFF0F1A0B0B20010041000B1A61| &&
      |62636465666768696A6B6C6D6E6F707172737475767778797A|.

  ENDMETHOD.

  METHOD testsuite_block.

* https://github.com/WebAssembly/spec/blob/master/test/core/block.wast

    rv_xstr =
      |0061736D01000000013D0B60027F7F017F6000006000017F60017F0060037F7C| &&
      |7F037F7C7F6000037F7E7F60017F017F6000027F7F6000027D7D6000037F7F7E| &&
      |60027F7F027F7F03383701010202020202020202020201020202020202000202| &&
      |0201010206020201020202020202020202020202020209020202020202020202| &&
      |010405017001010105030100010606017F01410A0B07D0063405656D70747900| &&
      |010873696E67756C61720002056D756C74690003066E65737465640004046465| &&
      |657000050F61732D73656C6563742D666972737400060D61732D73656C656374| &&
      |2D6D696400070E61732D73656C6563742D6C61737400080D61732D6C6F6F702D| &&
      |666972737400090B61732D6C6F6F702D6D6964000A0C61732D6C6F6F702D6C61| &&
      |7374000B0F61732D69662D636F6E646974696F6E000C0A61732D69662D746865| &&
      |6E000D0A61732D69662D656C7365000E0E61732D62725F69662D666972737400| &&
      |0F0D61732D62725F69662D6C61737400101161732D62725F7461626C652D6669| &&
      |72737400111061732D62725F7461626C652D6C61737400121661732D63616C6C| &&
      |5F696E6469726563742D666972737400141461732D63616C6C5F696E64697265| &&
      |63742D6D696400151561732D63616C6C5F696E6469726563742D6C6173740016| &&
      |0E61732D73746F72652D666972737400170D61732D73746F72652D6C61737400| &&
      |181461732D6D656D6F72792E67726F772D76616C756500190D61732D63616C6C| &&
      |2D76616C7565001B0F61732D72657475726E2D76616C7565001C0F61732D6472| &&
      |6F702D6F706572616E64001D0B61732D62722D76616C7565001E1261732D6C6F| &&
      |63616C2E7365742D76616C7565001F1261732D6C6F63616C2E7465652D76616C| &&
      |756500201361732D676C6F62616C2E7365742D76616C756500210F61732D6C6F| &&
      |61642D6F706572616E6400221061732D756E6172792D6F706572616E64002311| &&
      |61732D62696E6172792D6F706572616E6400240F61732D746573742D6F706572| &&
      |616E6400251261732D636F6D706172652D6F706572616E6400261261732D6269| &&
      |6E6172792D6F706572616E647300271361732D636F6D706172652D6F70657261| &&
      |6E647300281161732D6D697865642D6F706572616E647300290A627265616B2D| &&
      |62617265002A0B627265616B2D76616C7565002B11627265616B2D6D756C7469| &&
      |2D76616C7565002C0E627265616B2D7265706561746564002D0B627265616B2D| &&
      |696E6E6572002E05706172616D002F06706172616D73003009706172616D732D| &&
      |696400310B706172616D2D627265616B00320C706172616D732D627265616B00| &&
      |330F706172616D732D69642D627265616B003407656666656374730035087479| &&
      |70652D75736500360907010041000B01130AD2083702000B080002400B02400B| &&
      |0B0B000240010B027F41070B0B3E00024010001000100010000B027F10001000| &&
      |1000410710000B1A020510001000100041081000100010001000420710001000| &&
      |10001000410910000B1A1A0B1500027F0240100002400B010B027F100041090B| &&
      |0B0B7900027F027F027F027F027F027F027F027F027F027F027F027F027F027F| &&
      |027F027F027F027F027F027F027F027F027F027F027F027F027F027F027F027F| &&
      |027F027F027F027F027F027F027F027F10004196010B0B0B0B0B0B0B0B0B0B0B| &&
      |0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0B0C00027F| &&
      |41010B410241031B0B0C004102027F41010B41031B0B0C0041024103027F4101| &&
      |0B1B0B0E00037F027F41010B100010000B0B0E00037F1000027F41010B10000B| &&
      |0B0E00037F10001000027F41010B0B0B0C00027F41010B044010000B0B0F0041| &&
      |01047F027F41010B0541020B0B0F004101047F410205027F41010B0B0B0E0002| &&
      |7F027F41010B41020D000B0B0E00027F4102027F41010B0D000B0B1000027F02| &&
      |7F41010B41020E0100000B0B1000027F4102027F41010B0E0100000B0B040020| &&
      |000B1100027F027F41010B410241001100000B0B1100027F4102027F41010B41| &&
      |001100000B0B1100027F41014102027F41000B1100000B0B0C00027F41010B41| &&
      |013602000B0C00410A027F41010B3602000B0900027F41010B40000B04002000| &&
      |0B0900027F41010B101A0B0800027F41010B0F0B0800027F41010B1A0B0C0002| &&
      |7F027F41010B0C000B0B0D01017F027F41010B210020000B0B01017F027F4101| &&
      |0B22000B0B00027F41010B240023000B0A00027F41010B2802000B0A00027F10| &&
      |00410D0B680B1100027F100041030B027F100041040B6C0B0A00027F1000410D| &&
      |0B450B1700027D100043000040400B027D100043000040400B5E0B0E00020710| &&
      |004103100041040B6C0B1400020810004300004040100043000040400B5E0B11| &&
      |00020710004103100041040B41056A6C0B260002400C00000B024041010D0000| &&
      |0B024041000E0000000B024041010E02000000000B41130B0B00027F41120C00| &&
      |41130B0B130002094112416E42120C004113416D42130B0B3100027F41120C00| &&
      |41130C00411441000D001A411441010D001A41150C00411641040E0000411741| &&
      |010E0200000041150B0B4501017F410021002000027F027F41010C010B0B6A21| &&
      |002000027F02400C000B41020B6A21002000027F41040C00680B6A2100200002| &&
      |7F027F41080C010B680B6A210020000B0A004101020641026A0B0B0A00410141| &&
      |0202006A0B0B0A0041014102020A0B6A0B0C004101020641026A0C000B0B0C00| &&
      |4101410202006A0C000B0B0C0041014102020A0C000B6A0B2F01017F02404101| &&
      |2100200041036C2100200041056B2100200041076C21000C00200041E4006C21| &&
      |000B20004172460B3D0002400B027F41000B02031A0B41004400000000000000| &&
      |00410002040B1A1A1A027F41000B02031A0B4100440000000000000000410002| &&
      |040B1A1A1A0B|.

  ENDMETHOD.

ENDCLASS.
